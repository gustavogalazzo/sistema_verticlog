<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Painel Verticlog</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/style.css" />

    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quagga@0.12.1/dist/quagga.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>
      // Configura o "trabalhador" do PDF.js (Necess√°rio para funcionar)
      pdfjsLib.GlobalWorkerOptions.workerSrc =
        'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js'
    </script>

    <style>
      /* ========================================= */
      /* CSS DO DASHBOARD (Layout & Sidebar)       */
      /* ========================================= */

      .dashboard-layout {
        display: flex;
        height: 100vh;
        overflow: hidden;
        position: relative; /* Necess√°rio para o menu m√≥vel */
      }

      /* Sidebar (Menu Lateral) */
      .sidebar {
        width: 260px;
        background-color: var(--white);
        border-right: 1px solid #e2e8f0;
        display: flex;
        flex-direction: column;
        padding: 20px;
        transition: left 0.3s ease; /* Anima√ß√£o suave */
        z-index: 1000;
      }

      .brand {
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--primary-color);
        margin-bottom: 40px;
        padding-left: 10px;
      }

      .menu-item {
        padding: 12px 15px;
        margin-bottom: 5px;
        border-radius: 8px;
        color: var(--text-light);
        text-decoration: none;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.2s;
        cursor: pointer;
      }
      .menu-item:hover,
      .menu-item.active {
        background-color: #f1f5f9;
        color: var(--primary-color);
      }
      .menu-titulo {
        font-size: 0.75rem;
        text-transform: uppercase;
        color: #94a3b8;
        font-weight: 700;
        margin: 20px 0 10px 10px;
      }

      /* Conte√∫do Principal */
      .main-content {
        flex: 1;
        background-color: #f8fafc;
        overflow-y: auto;
        padding: 30px;
        width: 100%;
      }

      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
      }
      .user-profile {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .avatar-circle {
        width: 40px;
        height: 40px;
        background: var(--primary-color);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }

      /* Cards e Tabelas */
      .card {
        background: white;
        padding: 25px;
        border-radius: 12px;
        box-shadow: var(--shadow, 0 4px 6px -1px rgba(0, 0, 0, 0.1));
        margin-bottom: 25px;
        border: 1px solid #e2e8f0;
      }
      .card h3 {
        font-size: 1.1rem;
        color: var(--text-dark);
        margin-bottom: 20px;
        border-bottom: 1px solid #f1f5f9;
        padding-bottom: 10px;
      }

      .btn-logout {
        background-color: transparent;
        color: var(--danger, #ef4444);
        border: 1px solid var(--danger, #ef4444);
        padding: 8px 15px;
        border-radius: 6px;
        cursor: pointer;
      }
      .btn-logout:hover {
        background-color: #fee2e2;
      }

      .section-view {
        display: none;
      }
      .section-view.active {
        display: block;
      }

      /* ========================================= */
      /* RESPONSIVIDADE (CELULAR)                  */
      /* ========================================= */

      /* Esconde elementos m√≥veis no PC */
      .mobile-menu-btn {
        display: none;
      }
      .overlay {
        display: none;
      }

      @media (max-width: 768px) {
        .dashboard-layout {
          flex-direction: column;
        }

        /* Sidebar Escondida */
        .sidebar {
          position: fixed;
          top: 0;
          left: -280px;
          height: 100vh;
          box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
        }
        .sidebar.active {
          left: 0;
        }

        /* Bot√£o Menu */
        .mobile-menu-btn {
          display: block;
          background: none;
          border: none;
          font-size: 1.8rem;
          color: var(--primary-color);
          cursor: pointer;
          padding: 5px;
          margin-right: 10px;
        }

        /* Fundo Escuro */
        .overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          z-index: 900;
        }
        .overlay.active {
          display: block;
        }

        /* Ajustes de Conte√∫do */
        .main-content {
          padding: 15px;
        }

        .header-top h2 {
          font-size: 1.2rem;
          margin: 0;
        }
        .header-top p {
          display: none;
        }
        .user-profile span,
        .user-profile #welcomeMsg,
        .user-profile #userRoleDisplay {
          display: none;
        }

        /* Grids viram colunas */
        .section-view > div {
          grid-template-columns: 1fr !important;
          display: flex !important;
          flex-direction: column;
          gap: 15px !important;
        }

        /* Tabelas com scroll */
        .card table {
          display: block;
          width: 100%;
          overflow-x: auto;
          white-space: nowrap;
        }

        /* Modais */
        .card[style*='width: 400px'],
        .card[style*='width: 450px'],
        .card[style*='width: 500px'] {
          width: 95% !important;
          padding: 15px !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="dashboard-layout">
      <div class="overlay" onclick="toggleMenu()"></div>

      <nav class="sidebar" id="sidebarMenu">
        <div class="brand">Verticlog V3</div>

        <div class="menu-titulo">Financeiro</div>
        <a onclick="navegar('contas')" class="menu-item active"
          >üìä Contas a Pagar</a
        >
        <a onclick="navegar('relatorios')" class="menu-item"
          >üìà Relat√≥rios & Excel</a
        >

        <div class="menu-titulo">Log√≠stica</div>
        <a onclick="navegar('estoque')" class="menu-item"
          >üì¶ Estoque (Porta Pallets)</a
        >
        <a onclick="navegar('orcamentos')" class="menu-item">üìÑ Or√ßamentos</a>

        <div class="menu-titulo">Administrativo</div>
        <div id="menuAdmin" style="display: none">
          <a onclick="navegar('usuarios')" class="menu-item"
            >üë• Gerenciar Usu√°rios</a
          >
        </div>
      </nav>

      <main class="main-content">
        <div class="header-top">
          <button class="mobile-menu-btn" onclick="toggleMenu()">‚ò∞</button>

          <div style="flex: 1">
            <h2 id="pageTitle">Contas a Pagar</h2>
            <p style="color: var(--text-light)">
              Gerencie os pagamentos da empresa
            </p>
          </div>

          <div class="user-profile">
            <div class="avatar-circle" id="userInitials">U</div>
            <div>
              <div id="welcomeMsg" style="font-weight: 600; font-size: 0.9rem">
                Usu√°rio
              </div>
              <div
                id="userRoleDisplay"
                style="font-size: 0.8rem; color: var(--text-light)"
              >
                Cargo
              </div>
            </div>
            <button
              onclick="logout()"
              class="btn-logout"
              style="margin-left: 15px"
            >
              Sair
            </button>
          </div>
        </div>

        <div id="sec-contas" class="section-view active">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px">
            <div class="card">
              <h3>‚ö° Lan√ßamento R√°pido</h3>
              <form id="formConta">
                <div class="input-group">
                  <label>Descri√ß√£o</label>
                  <input
                    type="text"
                    id="desc"
                    required
                    placeholder="Ex: Conta de Luz"
                  />
                </div>
                <div style="display: flex; gap: 15px">
                  <div class="input-group">
                    <label>Valor (R$)</label>
                    <input
                      type="number"
                      id="amount"
                      step="0.01"
                      required
                      placeholder="0.00"
                    />
                  </div>
                  <div class="input-group">
                    <label>Vencimento</label>
                    <input type="date" id="date" required />
                  </div>
                </div>
                <button
                  type="button"
                  onclick="toggleLeitor()"
                  style="
                    width: 100%;
                    margin-bottom: 10px;
                    background: #64748b;
                    color: white;
                    padding: 10px;
                    border: none;
                    border-radius: 6px;
                    cursor: pointer;
                  "
                >
                  üì∑ Abrir Leitor de Boleto
                </button>
                <div class="input-group">
                  <label>Anexar Conta (PDF/Img)</label>
                  <input
                    type="file"
                    id="fileBill"
                    accept="image/*,application/pdf"
                  />
                </div>
                <button type="submit" class="btn-primary" style="width: 100%">
                  Salvar Lan√ßamento
                </button>
              </form>
            </div>

            <div class="card">
              <h3>üìÖ Vis√£o Mensal</h3>
              <div id="calendar" style="height: 400px"></div>
            </div>
          </div>

          <div class="card">
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
              "
            >
              <h3>√öltimos Lan√ßamentos</h3>
            </div>

            <div
              style="
                background: #f8fafc;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
                display: flex;
                gap: 15px;
                align-items: flex-end;
                flex-wrap: wrap;
              "
            >
              <div
                class="input-group"
                style="margin: 0; flex: 1; min-width: 150px"
              >
                <label style="font-size: 0.8rem">De (Vencimento)</label>
                <input
                  type="date"
                  id="filtroContaInicio"
                  style="padding: 8px; width: 100%; box-sizing: border-box"
                />
              </div>
              <div
                class="input-group"
                style="margin: 0; flex: 1; min-width: 150px"
              >
                <label style="font-size: 0.8rem">At√©</label>
                <input
                  type="date"
                  id="filtroContaFim"
                  style="padding: 8px; width: 100%; box-sizing: border-box"
                />
              </div>
              <div
                class="input-group"
                style="margin: 0; flex: 1; min-width: 150px"
              >
                <label style="font-size: 0.8rem">Status</label>
                <select
                  id="filtroContaStatus"
                  style="
                    padding: 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    width: 100%;
                  "
                >
                  <option value="todos">Todos</option>
                  <option value="pendente">Pendente</option>
                  <option value="pago">Pago</option>
                </select>
              </div>
              <button
                onclick="filtrarTabelaContas()"
                class="btn-primary"
                style="padding: 8px 20px; height: 38px"
              >
                üîç Filtrar
              </button>
              <button
                onclick="limparFiltrosContas()"
                style="
                  padding: 8px 15px;
                  height: 38px;
                  background: #94a3b8;
                  color: white;
                  border: none;
                  border-radius: 6px;
                  cursor: pointer;
                "
              >
                Limpar
              </button>
            </div>

            <table style="width: 100%; border-collapse: collapse">
              <thead>
                <tr
                  style="
                    text-align: left;
                    color: var(--text-light);
                    border-bottom: 2px solid #f1f5f9;
                  "
                >
                  <th style="padding: 10px">Descri√ß√£o</th>
                  <th>Valor</th>
                  <th>Vencimento</th>
                  <th>Respons√°vel</th>
                  <th>Status</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody id="listaContas"></tbody>
            </table>
          </div>

          <div
            id="leitorCard"
            class="card"
            style="display: none; border: 2px solid var(--accent-color)"
          >
            <h3>üì∏ Leitor Inteligente (Beta)</h3>
            <div class="input-group">
              <label>C√≥digo Manual</label>
              <input
                type="text"
                id="linhaDigitavelManual"
                placeholder="Cole o c√≥digo aqui..."
              />
            </div>
            <div class="input-group">
              <label>Arquivo (Imagem)</label>
              <input
                type="file"
                id="boletoFile"
                accept="image/*,application/pdf"
              />
            </div>
            <p
              id="leitorResultado"
              style="color: var(--primary-color); font-weight: bold"
            ></p>
            <div
              id="interactive"
              class="viewport"
              style="
                width: 100%;
                height: 200px;
                display: none;
                overflow: hidden;
              "
            ></div>
            <button id="iniciarLeitorBtn" class="btn-primary">Processar</button>
          </div>
        </div>

        <div id="sec-relatorios" class="section-view">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 20px;
            "
          >
            <h3>üìä Vis√£o Geral Financeira</h3>
            <button
              onclick="exportarExcel()"
              style="
                background-color: #217346;
                color: white;
                border: none;
                padding: 10px;
                border-radius: 6px;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
              "
            >
              üì• Baixar Planilha Excel
            </button>
          </div>

          <div
            style="
              display: grid;
              grid-template-columns: repeat(3, 1fr);
              gap: 20px;
              margin-bottom: 30px;
            "
          >
            <div
              class="card"
              style="border-left: 5px solid #f59e0b; padding: 20px"
            >
              <span style="color: #64748b; font-size: 0.9rem"
                >Contas a Pagar (Pendente)</span
              >
              <h2
                id="kpiPendente"
                style="font-size: 1.8rem; color: #333; margin-top: 5px"
              >
                R$ 0,00
              </h2>
            </div>
            <div
              class="card"
              style="border-left: 5px solid #10b981; padding: 20px"
            >
              <span style="color: #64748b; font-size: 0.9rem"
                >Total Pago (Geral)</span
              >
              <h2
                id="kpiPago"
                style="font-size: 1.8rem; color: #333; margin-top: 5px"
              >
                R$ 0,00
              </h2>
            </div>
            <div
              class="card"
              style="border-left: 5px solid #ef4444; padding: 20px"
            >
              <span style="color: #64748b; font-size: 0.9rem"
                >üö® Contas Atrasadas</span
              >
              <h2
                id="kpiAtrasado"
                style="font-size: 1.8rem; color: #ef4444; margin-top: 5px"
              >
                R$ 0,00
              </h2>
            </div>
          </div>

          <div class="card">
            <h3>Extrato Completo</h3>
            <div
              style="
                background: #f8fafc;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
                display: flex;
                gap: 15px;
                align-items: flex-end;
                flex-wrap: wrap;
              "
            >
              <div
                class="input-group"
                style="margin: 0; flex: 1; min-width: 150px"
              >
                <label style="font-size: 0.8rem">De (Data)</label>
                <input
                  type="date"
                  id="filtroRelInicio"
                  style="padding: 8px; width: 100%; box-sizing: border-box"
                />
              </div>
              <div
                class="input-group"
                style="margin: 0; flex: 1; min-width: 150px"
              >
                <label style="font-size: 0.8rem">At√©</label>
                <input
                  type="date"
                  id="filtroRelFim"
                  style="padding: 8px; width: 100%; box-sizing: border-box"
                />
              </div>
              <div
                class="input-group"
                style="margin: 0; flex: 1; min-width: 150px"
              >
                <label style="font-size: 0.8rem">Status</label>
                <select
                  id="filtroRelStatus"
                  style="
                    padding: 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    width: 100%;
                  "
                >
                  <option value="todos">Todos</option>
                  <option value="pendente">Pendente</option>
                  <option value="pago">Pago</option>
                </select>
              </div>
              <button
                onclick="filtrarRelatorios()"
                class="btn-primary"
                style="padding: 8px 20px; height: 38px"
              >
                üîç Filtrar
              </button>
            </div>

            <table style="width: 100%; border-collapse: collapse">
              <thead>
                <tr style="text-align: left; border-bottom: 2px solid #ddd">
                  <th style="padding: 10px">Vencimento</th>
                  <th>Descri√ß√£o</th>
                  <th>Valor</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="listaRelatorio"></tbody>
            </table>
          </div>
        </div>

        <div id="sec-estoque" class="section-view">
          <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px">
            <div class="card">
              <h3>üì¶ Novo Material</h3>
              <form id="formEstoque">
                <div class="input-group">
                  <label>Nome do Item</label>
                  <input
                    type="text"
                    id="prodName"
                    required
                    placeholder="Ex: Montante 3m"
                  />
                </div>
                <div class="input-group">
                  <label>Categoria</label>
                  <select
                    id="prodCategory"
                    style="
                      width: 100%;
                      padding: 10px;
                      border: 1px solid #ddd;
                      border-radius: 8px;
                    "
                  >
                    <option value="Estrutura">Estrutura (A√ßo)</option>
                    <option value="Acessorio">Acess√≥rio/Parafuso</option>
                    <option value="Servico">Servi√ßo/M√£o de Obra</option>
                  </select>
                </div>
                <div style="display: flex; gap: 10px">
                  <div class="input-group">
                    <label>Qtd.</label>
                    <input
                      type="number"
                      id="prodQtd"
                      required
                      placeholder="0"
                    />
                  </div>
                  <div class="input-group">
                    <label>Pre√ßo Unit. (R$)</label>
                    <input
                      type="number"
                      id="prodPrice"
                      step="0.01"
                      required
                      placeholder="0.00"
                    />
                  </div>
                </div>
                <button
                  type="submit"
                  class="btn-primary"
                  style="width: 100%; margin-top: 10px"
                >
                  Cadastrar Item
                </button>
              </form>
            </div>

            <div class="card">
              <h3>Invent√°rio Atual</h3>
              <table style="width: 100%; border-collapse: collapse">
                <thead>
                  <tr
                    style="
                      text-align: left;
                      color: var(--text-light);
                      border-bottom: 2px solid #f1f5f9;
                    "
                  >
                    <th style="padding: 10px">Item</th>
                    <th>Categoria</th>
                    <th>Qtd.</th>
                    <th>Pre√ßo</th>
                    <th>A√ß√£o</th>
                  </tr>
                </thead>
                <tbody id="listaEstoque"></tbody>
              </table>
            </div>
          </div>
        </div>

        <div id="sec-orcamentos" class="section-view">
          <div
            style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 20px"
          >
            <div class="card">
              <h3>üìÑ Dados do Or√ßamento</h3>
              <h4 style="margin-top: 10px; color: var(--primary-color)">
                1. Cliente
              </h4>
              <div class="input-group">
                <label>Nome do Cliente / Empresa</label>
                <input
                  type="text"
                  id="orcClientName"
                  placeholder="Ex: Supermercados ABC Ltda"
                />
              </div>
              <div class="input-group">
                <label>CNPJ / CPF</label>
                <input
                  type="text"
                  id="orcClientDoc"
                  placeholder="00.000.000/0000-00"
                />
              </div>

              <h4 style="margin-top: 20px; color: var(--primary-color)">
                2. Adicionar Itens
              </h4>
              <div class="input-group">
                <label>Selecione do Estoque</label>
                <select
                  id="orcSelectEstoque"
                  style="
                    width: 100%;
                    padding: 10px;
                    border: 1px solid #ddd;
                    border-radius: 8px;
                  "
                >
                  <option value="">Carregando itens...</option>
                </select>
              </div>
              <div style="display: flex; gap: 10px; align-items: flex-end">
                <div class="input-group" style="flex: 1">
                  <label>Quantidade</label>
                  <input type="number" id="orcQtd" value="1" min="1" />
                </div>
                <button
                  onclick="adicionarAoOrcamento()"
                  class="btn-primary"
                  style="height: 48px"
                >
                  ‚ûï Adicionar
                </button>
              </div>
            </div>

            <div class="card">
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                "
              >
                <h3>Pr√©via do Documento</h3>
                <button
                  onclick="gerarPDF()"
                  style="
                    background: var(--success);
                    color: white;
                    border: none;
                    padding: 10px;
                    border-radius: 6px;
                    cursor: pointer;
                  "
                >
                  üñ®Ô∏è Baixar PDF
                </button>
              </div>

              <table
                style="width: 100%; border-collapse: collapse; margin-top: 15px"
              >
                <thead>
                  <tr
                    style="border-bottom: 2px solid #ddd; background: #f9f9f9"
                  >
                    <th style="padding: 10px; text-align: left">Item</th>
                    <th>Qtd</th>
                    <th>Unit.</th>
                    <th>Total</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="listaOrcamento">
                  <tr>
                    <td
                      colspan="5"
                      style="text-align: center; padding: 20px; color: #aaa"
                    >
                      Nenhum item adicionado.
                    </td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr
                    style="
                      border-top: 2px solid #333;
                      font-weight: bold;
                      font-size: 1.1rem;
                    "
                  >
                    <td colspan="3" style="padding: 15px; text-align: right">
                      VALOR TOTAL:
                    </td>
                    <td id="orcTotalFinal" style="color: var(--primary-color)">
                      R$ 0,00
                    </td>
                    <td></td>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        </div>

        <div id="sec-usuarios" class="section-view">
          <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px">
            <div class="card">
              <h3>üë§ Novo Funcion√°rio</h3>
              <form id="formNovoUsuario">
                <div class="input-group">
                  <label>Nome Completo</label>
                  <input
                    type="text"
                    id="newUserName"
                    required
                    placeholder="Ex: Jo√£o Silva"
                  />
                </div>
                <div class="input-group">
                  <label>E-mail de Acesso</label>
                  <input
                    type="email"
                    id="newUserEmail"
                    required
                    placeholder="joao@verticlog.com"
                  />
                </div>
                <div class="input-group">
                  <label>Senha Inicial</label>
                  <input
                    type="password"
                    id="newUserPass"
                    required
                    placeholder="******"
                  />
                </div>
                <div class="input-group">
                  <label>N√≠vel de Acesso</label>
                  <select
                    id="newUserRole"
                    style="
                      width: 100%;
                      padding: 12px;
                      border: 1px solid #e2e8f0;
                      border-radius: 8px;
                    "
                  >
                    <option value="user">Colaborador (V√™ apenas o seu)</option>
                    <option value="admin">Administrador (V√™ tudo)</option>
                  </select>
                </div>
                <button
                  type="submit"
                  class="btn-primary"
                  style="width: 100%; margin-top: 10px"
                >
                  Cadastrar Usu√°rio
                </button>
              </form>
            </div>

            <div class="card">
              <h3>Equipe Cadastrada</h3>
              <table style="width: 100%; border-collapse: collapse">
                <thead>
                  <tr
                    style="
                      text-align: left;
                      color: var(--text-light);
                      border-bottom: 2px solid #f1f5f9;
                    "
                  >
                    <th style="padding: 10px">ID</th>
                    <th>Nome</th>
                    <th>Email</th>
                    <th>Cargo</th>
                    <th>A√ß√£o</th>
                  </tr>
                </thead>
                <tbody id="listaUsuarios"></tbody>
              </table>
            </div>
          </div>
        </div>
      </main>
    </div>

    <div
      id="modalPagamento"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
    >
      <div class="card" style="width: 400px; padding: 30px">
        <h3>‚úÖ Confirmar Pagamento</h3>
        <p>Deseja anexar o comprovante agora?</p>
        <input type="hidden" id="pagamentoIdConta" />
        <div class="input-group" style="margin: 20px 0">
          <label>Comprovante (Opcional)</label>
          <input type="file" id="fileProof" accept="image/*,application/pdf" />
        </div>
        <div style="display: flex; gap: 10px; justify-content: flex-end">
          <button
            onclick="fecharModalPagamento()"
            style="
              background: #ccc;
              color: #333;
              padding: 8px 15px;
              border: none;
              border-radius: 6px;
              cursor: pointer;
            "
          >
            Cancelar
          </button>
          <button
            onclick="confirmarPagamentoComAnexo()"
            class="btn-primary"
            style="background: var(--success)"
          >
            Confirmar Baixa
          </button>
        </div>
      </div>
    </div>

    <div
      id="modalEditarUsuario"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
    >
      <div class="card" style="width: 400px; padding: 30px">
        <h3>‚úèÔ∏è Editar Funcion√°rio</h3>
        <input type="hidden" id="editUserId" />
        <div class="input-group">
          <label>Nome</label>
          <input type="text" id="editUserName" />
        </div>
        <div class="input-group">
          <label>Email</label>
          <input type="email" id="editUserEmail" />
        </div>
        <div class="input-group">
          <label>Cargo</label>
          <select
            id="editUserRole"
            style="
              width: 100%;
              padding: 12px;
              border: 1px solid #e2e8f0;
              border-radius: 8px;
            "
          >
            <option value="user">Colaborador</option>
            <option value="admin">Administrador</option>
          </select>
        </div>
        <div
          style="
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
          "
        >
          <button
            onclick="document.getElementById('modalEditarUsuario').style.display='none'"
            style="
              background: #ccc;
              color: #333;
              padding: 8px 15px;
              border: none;
              border-radius: 6px;
              cursor: pointer;
            "
          >
            Cancelar
          </button>
          <button onclick="salvarEdicaoUsuario()" class="btn-primary">
            Salvar Altera√ß√µes
          </button>
        </div>
      </div>
    </div>

    <div
      id="modalDetalhesDia"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
    >
      <div
        class="card"
        style="width: 450px; padding: 25px; max-height: 80vh; overflow-y: auto"
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
          "
        >
          <h3 id="tituloDetalhesDia" style="margin: 0">üìÖ Contas do Dia</h3>
          <button
            onclick="document.getElementById('modalDetalhesDia').style.display='none'"
            style="
              background: none;
              border: none;
              font-size: 1.5rem;
              cursor: pointer;
            "
          >
            &times;
          </button>
        </div>
        <div id="conteudoDetalhesDia"></div>
        <div style="margin-top: 20px; text-align: right">
          <button
            onclick="document.getElementById('modalDetalhesDia').style.display='none'"
            style="
              background: #ccc;
              color: #333;
              padding: 8px 15px;
              border: none;
              border-radius: 6px;
              cursor: pointer;
            "
          >
            Fechar
          </button>
        </div>
      </div>
    </div>

    <div
      id="modalEditarConta"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
    >
      <div
        class="card"
        style="width: 500px; padding: 30px; max-height: 90vh; overflow-y: auto"
      >
        <h3>‚úèÔ∏è Gerenciar Lan√ßamento</h3>
        <input type="hidden" id="editContaId" />
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px">
          <div class="input-group">
            <label>Descri√ß√£o</label>
            <input type="text" id="editContaDesc" />
          </div>
          <div class="input-group">
            <label>Valor (R$)</label>
            <input type="number" step="0.01" id="editContaValor" />
          </div>
        </div>
        <div
          style="
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
          "
        >
          <div class="input-group">
            <label>Vencimento</label>
            <input type="date" id="editContaData" />
          </div>
          <div class="input-group">
            <label>Status Atual</label>
            <select
              id="editContaStatus"
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            >
              <option value="pendente">üü† Pendente</option>
              <option value="pago">üü¢ Pago</option>
            </select>
          </div>
        </div>
        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee" />
        <div class="input-group">
          <label>üìÑ Arquivo da Conta (Boleto/Fatura)</label>
          <div style="display: flex; gap: 10px; align-items: center">
            <input type="file" id="editFileBill" />
            <label
              ><input type="checkbox" id="rmFileBill" /> Remover atual?</label
            >
          </div>
        </div>
        <div class="input-group" style="margin-top: 10px">
          <label>üßæ Comprovante de Pagamento</label>
          <div style="display: flex; gap: 10px; align-items: center">
            <input type="file" id="editFileProof" />
            <label
              ><input type="checkbox" id="rmFileProof" /> Remover atual?</label
            >
          </div>
        </div>
        <div
          style="
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
          "
        >
          <button
            onclick="document.getElementById('modalEditarConta').style.display='none'"
            style="
              background: #ccc;
              color: #333;
              padding: 8px 15px;
              border: none;
              border-radius: 6px;
              cursor: pointer;
            "
          >
            Cancelar
          </button>
          <button onclick="salvarEdicaoConta()" class="btn-primary">
            Salvar Tudo
          </button>
        </div>
      </div>
    </div>

    <div
      id="modalAlertaHoje"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        align-items: center;
        justify-content: center;
        z-index: 2000;
      "
    >
      <div
        class="card"
        style="width: 450px; padding: 25px; border-top: 5px solid #e74c3c"
      >
        <div style="text-align: center; margin-bottom: 20px">
          <h2 style="color: #e74c3c; margin: 0">üîî Aten√ß√£o!</h2>
          <p style="color: #555">Existem contas vencendo <b>HOJE</b>:</p>
        </div>
        <div
          id="listaAlertaConteudo"
          style="
            background: #fff5f5;
            padding: 15px;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
          "
        ></div>
        <div style="margin-top: 20px; text-align: center">
          <button
            onclick="document.getElementById('modalAlertaHoje').style.display='none'"
            class="btn-primary"
            style="background: #333"
          >
            Entendi, vou verificar.
          </button>
        </div>
      </div>
    </div>

    <script src="../js/api.js"></script>
    <script src="../js/dashboard.js"></script>
    <script>
      // Pequeno script para controlar o menu lateral
      function navegar(secao) {
        // Esconde todas as se√ß√µes
        document
          .querySelectorAll('.section-view')
          .forEach(el => el.classList.remove('active'))
        document
          .querySelectorAll('.menu-item')
          .forEach(el => el.classList.remove('active'))

        // Mostra a selecionada
        document.getElementById('sec-' + secao).classList.add('active')

        // Atualiza t√≠tulo
        const titulos = {
          contas: 'Contas a Pagar',
          relatorios: 'Relat√≥rios & Exporta√ß√£o',
          estoque: 'Gest√£o de Estoque',
          orcamentos: 'Or√ßamentos & PDF',
          usuarios: 'Gest√£o de Usu√°rios'
        }
        document.getElementById('pageTitle').innerText = titulos[secao]

        if (secao === 'usuarios') {
          if (typeof carregarUsuarios === 'function') carregarUsuarios()
        }
        if (secao === 'estoque') {
          if (typeof carregarEstoque === 'function') carregarEstoque()
        }
        if (secao === 'orcamentos') {
          if (typeof carregarOpcoesEstoque === 'function')
            carregarOpcoesEstoque()
        }
        if (secao === 'relatorios') {
          if (typeof carregarRelatorios === 'function') carregarRelatorios()
        }
      }

      function toggleLeitor() {
        const leitor = document.getElementById('leitorCard')
        leitor.style.display =
          leitor.style.display === 'none' ? 'block' : 'none'
      }

      // Exibir menu admin se for admin
      const usr = JSON.parse(localStorage.getItem('usuarioVerticlog'))
      if (usr && usr.role === 'admin') {
        document.getElementById('menuAdmin').style.display = 'block'
      }
      if (usr) {
        document.getElementById('userRoleDisplay').innerText =
          usr.role === 'admin' ? 'Administrador' : 'Colaborador'
        document.getElementById('userInitials').innerText = usr.name
          .charAt(0)
          .toUpperCase()
      }

      // FUN√á√ÉO PARA ABRIR/FECHAR MENU NO CELULAR
      function toggleMenu() {
        const sidebar = document.getElementById('sidebarMenu')
        const overlay = document.querySelector('.overlay')

        sidebar.classList.toggle('active')
        overlay.classList.toggle('active')
      }

      // Fecha o menu automaticamente quando clica num item (no celular)
      document.querySelectorAll('.menu-item').forEach(item => {
        item.addEventListener('click', () => {
          // S√≥ fecha se estivermos no modo mobile (tela pequena)
          if (window.innerWidth <= 768) {
            toggleMenu()
          }
        })
      })
    </script>
  </body>
</html>
